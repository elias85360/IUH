{
  "apiVersion": 1,
  "groups": [
    {
      "orgId": 1,
      "name": "api.rules",
      "folder": "backend",
      "interval": "1m",
      "rules": [
        {
          "uid": "api-latency-p95",
          "title": "API p95 latency > 1s",
          "for": "1m",
          "noDataState": "NoData",
          "execErrState": "Error",
          "condition": "C",
          "data": [
            {
              "refId": "A",
              "queryType": "timeSeriesQuery",
              "relativeTimeRange": {"from": 300, "to": 0},
              "datasourceUid": "prometheus",
              "model": {
                "expr": "histogram_quantile(0.95, sum(rate(http_request_duration_seconds_bucket[5m])) by (le))",
                "legendFormat": "p95",
                "interval": "1m"
              }
            },
            {"refId":"B","queryType":"classic_conditions","datasourceUid":"-100","model":{"type":"classic_conditions","conditions":[{"evaluator":{"type":"gt","params":[1]},"query":{"params":["A"]},"reducer":{"type":"last"},"type":"query","operator":{"type":"and"}}]}}
          ]
        },
        {
          "uid": "api-error-rate",
          "title": "API error rate > 1%",
          "for": "1m",
          "noDataState": "NoData",
          "execErrState": "Error",
          "condition": "C",
          "data": [
            {
              "refId": "A",
              "queryType": "timeSeriesQuery",
              "relativeTimeRange": {"from": 300, "to": 0},
              "datasourceUid": "prometheus",
              "model": {
                "expr": "sum(rate(http_errors_total[5m])) / sum(rate(http_requests_total[5m]))",
                "legendFormat": "error_rate",
                "interval": "1m"
              }
            },
            {"refId":"B","queryType":"classic_conditions","datasourceUid":"-100","model":{"type":"classic_conditions","conditions":[{"evaluator":{"type":"gt","params":[0.01]},"query":{"params":["A"]},"reducer":{"type":"last"},"type":"query","operator":{"type":"and"}}]}}
          ]
        }
      ]
    }
  ]
}
